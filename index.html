<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>I love you Riddhima ‚ù§Ô∏è</title>
  <meta name="theme-color" content="#ff2d95" />
  <meta name="description" content="A little surprise for Riddhima ‚Äî will you marry me?" />
  <meta property="og:title" content="I love you Riddhima ‚ù§Ô∏è" />
  <meta property="og:description" content="A little surprise for Riddhima ‚Äî will you marry me?" />
  <meta property="og:type" content="website" />
  <style>
    :root{
      --bg1:#fff5f8; --bg2:#fff0f6; --bg3:#fffaf0;
      --accent:#ff2d95; --accent-2:#ff4d94; --text:#2b2b2b;
    }
    html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial}
    body{
      background:linear-gradient(120deg,var(--bg1) 0%, var(--bg2) 50%, var(--bg3) 100%);
      overflow:hidden; color:var(--text);
      animation:bgShift 10s ease-in-out infinite alternate;
    }
    @keyframes bgShift{
      0%{filter:hue-rotate(0deg)}
      100%{filter:hue-rotate(8deg)}
    }

    /* Floating hearts canvas */
    #floatLayer{position:fixed;inset:0;z-index:0;pointer-events:none}

    /* Soft love wall */
    .love-wall{position:absolute;inset:0;display:flex;flex-wrap:wrap;padding:18px;gap:10px;align-content:flex-start;overflow:auto;opacity:0.16}
    .love-item{font-weight:600;font-size:13px;white-space:nowrap}

    /* Center card */
    .center{
      position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);
      background:rgba(255,255,255,0.9);backdrop-filter:blur(8px);
      border-radius:20px;padding:28px 30px;text-align:center;
      box-shadow:0 12px 34px rgba(0,0,0,0.10);min-width:320px; z-index:1;
    }
    h1{margin:0 0 6px 0;font-size:22px;color:var(--accent)}
    p.question{margin:4px 0 16px 0;font-size:17px;min-height:24px}
    .type-caret{display:inline-block;width:1px;height:1em;background:var(--accent);vertical-align:-2px;margin-left:3px;animation:blink 1s steps(1,end) infinite}
    @keyframes blink{50%{opacity:0}}

    .buttons{display:flex;gap:14px;justify-content:center;align-items:center;flex-wrap:wrap}
    button{
      padding:12px 20px;border-radius:12px;border:2px solid transparent;
      font-weight:700;cursor:pointer;font-size:15px;outline:none
    }
    .btn-yes{
      background:linear-gradient(90deg,#ff8ccf,#ff4d94);color:white;
      box-shadow:0 8px 20px rgba(255,77,148,0.28); transform:translateZ(0);
    }
    .btn-yes:hover{filter:brightness(1.03)}
    .btn-no{background:transparent;color:var(--accent);border-color:var(--accent);position:relative}

    /* Emoji bloom */
    .flower{font-size:46px;opacity:0;transform:translateY(12px) scale(0.7);transition:all .6s cubic-bezier(.2,.9,.3,1);display:inline-block}
    .flower.show{opacity:1;transform:translateY(-8px) scale(1)}

    /* Confetti layer */
    .confetti{pointer-events:none;position:fixed;inset:0;overflow:hidden;z-index:2}

    /* Footer hint */
    .hint{margin-top:12px;font-size:12px;opacity:0.7}

    /* Responsive */
    @media (max-width:480px){
      .center{padding:22px 18px;border-radius:16px;margin:12px;min-width:260px}
      .buttons{gap:10px}
    }
  </style>
</head>
<body>
  <canvas id="floatLayer" aria-hidden="true"></canvas>

  <div class="love-wall" id="loveWall" aria-hidden="true"></div>

  <div class="center" role="dialog" aria-labelledby="title" aria-describedby="q">
    <h1 id="title">‚ù§Ô∏è A small question for Riddhima</h1>
    <p class="question" id="q"><span id="typeTarget"></span><span class="type-caret" aria-hidden="true"></span></p>
    <div class="buttons">
      <button class="btn-yes" id="yesBtn" aria-label="Yes">Yes üíç</button>
      <button class="btn-no" id="noBtn" aria-label="No">No ‚ùå</button>
    </div>
    <div style="height:18px;margin-top:14px;">
      <span class="flower" id="flower">üå∏</span>
    </div>
    <div class="hint" id="hint">Tap Yes for a surprise ‚ú®</div>
  </div>

  <div class="confetti" id="confetti" aria-hidden="true"></div>

  <script>
    // Helpers
    const $ = (sel, parent=document) => parent.querySelector(sel);

    // 1) Love wall
    (function makeWall(){
      const wall = $('#loveWall');
      const phrase = 'I love you Riddhima ‚ù§Ô∏è';
      for(let i=0;i<220;i++){
        const s = document.createElement('div');
        s.className='love-item';
        s.textContent = phrase;
        s.style.fontSize = (12 + (i%6)) + 'px';
        s.style.opacity = (0.08 + (i%8)*0.02);
        wall.appendChild(s);
      }
    })();

    // 2) Typewriter question (exposed as a function so we can restart on reset)
    function typeQuestion(){
      const text = 'Will you marry me?';
      const qEl = $('#q');
      qEl.innerHTML = '<span id="typeTarget"></span><span class="type-caret" aria-hidden="true"></span>';
      const tgt = $('#typeTarget');
      let i=0;
      (function step(){
        if(i<=text.length){
          tgt.textContent = text.slice(0,i++);
          setTimeout(step, i<6?80: i<12?85:95);
        }
      })();
    }
    typeQuestion();

    // 3) Floating hearts (requestAnimationFrame)
    (function floatingHearts(){
      const canvas = $('#floatLayer');
      const ctx = canvas.getContext('2d');
      let W,H, hearts=[];
      function resize(){
        W = canvas.width = window.innerWidth;
        H = canvas.height = window.innerHeight;
      }
      window.addEventListener('resize', resize, {passive:true});
      resize();

      function spawn(){
        const count = 18;
        hearts = [];
        for(let i=0;i<count;i++){
          hearts.push({
            x: Math.random()*W,
            y: Math.random()*H,
            s: 0.8 + Math.random()*1.8,
            a: 0.15 + Math.random()*0.35,
            vx: -0.2 + Math.random()*0.4,
            vy: -0.1 - Math.random()*0.3
          });
        }
      }
      spawn();

      function drawHeart(x,y,size,alpha){
        ctx.save();
        ctx.translate(x,y);
        ctx.scale(size,size);
        ctx.globalAlpha = alpha;
        ctx.fillStyle = '#ff6aaa';
        ctx.beginPath();
        ctx.moveTo(0,0);
        ctx.bezierCurveTo(-2,-2,-4,1,0,4);
        ctx.bezierCurveTo(4,1,2,-2,0,0);
        ctx.fill();
        ctx.restore();
      }

      function tick(){
        ctx.clearRect(0,0,W,H);
        for(const h of hearts){
          h.x += h.vx;
          h.y += h.vy;
          if(h.y < -10) { h.y = H+10; h.x = Math.random()*W; }
          drawHeart(h.x,h.y,h.s,h.a);
        }
        requestAnimationFrame(tick);
      }
      requestAnimationFrame(tick);
    })();

    // 4) Buttons and elements
    const center = document.querySelector('.center');
    const noBtn = $('#noBtn');
    const yesBtn = $('#yesBtn');
    const flower = $('#flower');
    const confetti = $('#confetti');
    const hint = $('#hint');

    function moveNoRandom() {
      const rect = center.getBoundingClientRect();
      const maxX = Math.max(10, rect.width - 110);
      const maxY = Math.max(10, rect.height - 60);
      const x = Math.floor(Math.random()*maxX);
      const y = Math.floor(Math.random()*maxY);
      noBtn.style.transform = `translate(${x}px, ${y}px)`;
    }

    // Avoid pointer
    noBtn.addEventListener('mouseenter', moveNoRandom);
    noBtn.addEventListener('click', (e)=>{ e.preventDefault(); moveNoRandom(); });
    noBtn.addEventListener('touchstart',(e)=>{ e.preventDefault(); moveNoRandom(); },{passive:false});
    document.addEventListener('mousemove',(e)=>{
      const nb = noBtn.getBoundingClientRect();
      const dx = e.clientX - (nb.left + nb.width/2);
      const dy = e.clientY - (nb.top + nb.height/2);
      const dist = Math.hypot(dx,dy);
      if(dist < 120){ moveNoRandom(); }
    });
    noBtn.addEventListener('focus',(e)=>{ moveNoRandom(); noBtn.blur(); });

    // 5) Confetti using Web Animations API
    function burstConfetti(){
      const emojis = ['‚ù§Ô∏è','üíñ','üå∏','üíê','üåπ','‚ú®'];
      for(let i=0;i<34;i++){
        const el = document.createElement('i');
        el.textContent = emojis[Math.floor(Math.random()*emojis.length)];
        el.style.position='absolute';
        el.style.left = Math.random()*100 + '%';
        el.style.top = '-10vh';
        el.style.fontSize = (12 + Math.random()*18) + 'px';
        confetti.appendChild(el);
        const anim = el.animate([
          { transform:`translateY(0) rotate(0deg)`, opacity:1 },
          { transform:`translateY(110vh) rotate(${180+Math.random()*360}deg)`, opacity:0 }
        ], { duration: 1600 + Math.random()*900, easing: 'linear', fill:'forwards' });
        anim.onfinish = ()=>{ if(el.parentNode) el.parentNode.removeChild(el); };
      }
    }

    // 6) Celebration chime with Web Audio API
    async function ding(){
      try{
        const AudioCtx = window.AudioContext || window.webkitAudioContext;
        const ctx = new AudioCtx();
        const o = ctx.createOscillator();
        const g = ctx.createGain();
        o.type = 'sine';
        o.frequency.setValueAtTime(660, ctx.currentTime);
        g.gain.setValueAtTime(0.0001, ctx.currentTime);
        g.gain.exponentialRampToValueAtTime(0.2, ctx.currentTime+0.02);
        g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime+0.45);
        o.connect(g).connect(ctx.destination);
        o.start();
        o.stop(ctx.currentTime+0.5);
      }catch(e){}
    }

    // 7) UI state helpers
    function setYesUI(){
      flower.classList.add('show');
      $('#q').textContent = 'Yes! She said YES! üíû';
      center.style.boxShadow = '0 18px 40px rgba(255,45,149,0.2)';
      noBtn.style.opacity = '0';
      noBtn.style.pointerEvents = 'none';
      hint.textContent = 'Wishing a lifetime of happiness üíó';
      yesBtn.animate(
        [{transform:'scale(0.98)'},{transform:'scale(1.06)'},{transform:'scale(1)'}],
        {duration:560,iterations:1,easing:'ease-out'}
      );
    }

    function resetUI(){
      // Hide celebration and restore base styles/content
      flower.classList.remove('show');
      center.style.boxShadow = '0 12px 34px rgba(0,0,0,0.10)';
      noBtn.style.opacity = '1';
      noBtn.style.pointerEvents = 'auto';
      noBtn.style.transform = 'translate(0, 0)';
      confetti.innerHTML = '';
      hint.textContent = 'Tap Yes for a surprise ‚ú®';
      typeQuestion(); // restart typewriter to original question
    }

    // 8) Click handler with 7s auto-reset
    let resetTimer = null; // track the scheduled reset so we can cancel if needed
    yesBtn.addEventListener('click', async ()=>{
      setYesUI();
      burstConfetti();
      await ding();

      // If a previous timer exists, cancel it and schedule a fresh 7s reset
      if (resetTimer) clearTimeout(resetTimer);
      resetTimer = setTimeout(()=>{
        resetUI();
        resetTimer = null;
      }, 7000);
    });
  </script>
</body>
</html>
